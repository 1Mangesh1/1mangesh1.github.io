---
// Simple visitor counter component using GoatCounter
---
<div id="visitor-counter" class="text-sm text-gray-600 dark:text-gray-400"></div>

<script>
  // Type declaration for GoatCounter
  declare global {
    interface Window {
      goatcounter?: {
        visit_count?: (options: any) => void;
      };
    }
  }

  // Simple visitor counter implementation
  function initVisitorCounter() {
    // Wait for GoatCounter to load
    if (typeof window.goatcounter === 'undefined') {
      setTimeout(initVisitorCounter, 100);
      return;
    }

    if (typeof window.goatcounter.visit_count !== 'function') {
      console.log('GoatCounter visit_count not available');
      return;
    }

    try {
      // Use the official GoatCounter visitor counter API with custom styling
      window.goatcounter.visit_count!({
        append: "#visitor-counter",
        no_branding: true,
        type: "html",
        style: `
          div {
            border: none !important;
            background-color: transparent !important;
            color: #6b7280 !important;
            font-size: 0.875rem !important;
            padding: 0 !important;
            border-radius: 0 !important;
            font-family: inherit !important;
            font-weight: inherit !important;
            line-height: inherit !important;
            display: inline !important;
            margin: 0 !important;
            box-shadow: none !important;
          }
          div:hover {
            color: #374151 !important;
          }
          .dark div {
            color: #9ca3af !important;
          }
          .dark div:hover {
            color: #d1d5db !important;
          }
          #gcvc-for {
            display: none !important;
          }
          #gcvc-by {
            display: none !important;
          }
          #gcvc-views {
            color: #3b82f6 !important;
            font-weight: 600 !important;
          }
          .dark #gcvc-views {
            color: #60a5fa !important;
          }
        `
      });
    } catch (error) {
      console.log('Visitor counter error:', error);
    }
  }

  // Initialize when DOM is ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initVisitorCounter);
  } else {
    initVisitorCounter();
  }
</script>

<style>
  #visitor-counter {
    display: inline-block;
    margin-left: 0.5rem;
  }
</style> 