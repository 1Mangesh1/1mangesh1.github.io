---
// Clean global counter using JSON API for better styling control
---
<div id="clean-global-counter" class="fixed bottom-4 left-4 z-50">
  <div class="bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg px-3 py-2 shadow-lg backdrop-blur-sm bg-opacity-90 dark:bg-opacity-90">
    <div class="flex items-center gap-2">
      <div class="text-blue-600 dark:text-blue-400">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
        </svg>
      </div>
      <div class="text-sm text-gray-600 dark:text-gray-400">
        <span id="clean-global-views">--</span> views
      </div>
    </div>
  </div>
</div>

<script>
  // Clean global counter using JSON API with fallback
  function initCleanGlobalCounter() {
    try {
      // Try JSON API first
      fetch('https://mangeshbide.goatcounter.com/counter/TOTAL.json')
        .then(response => {
          if (response.ok) {
            return response.json();
          } else {
            throw new Error(`HTTP ${response.status}`);
          }
        })
        .then(data => {
          const viewsElement = document.getElementById('clean-global-views');
          if (viewsElement) {
            viewsElement.textContent = data.count;
            viewsElement.className = 'text-blue-600 dark:text-blue-400 font-semibold';
          }
        })
        .catch(error => {
          console.log('JSON API failed, trying JavaScript API:', error);
          // Fallback to JavaScript API
          try {
            if (typeof (window as any).goatcounter !== 'undefined' && typeof (window as any).goatcounter.visit_count === 'function') {
              (window as any).goatcounter.visit_count!({
                append: "#clean-global-views",
                no_branding: true,
                type: "html",
                path: "TOTAL",
                style: `
                  div {
                    border: none !important;
                    background-color: transparent !important;
                    color: #3b82f6 !important;
                    font-size: inherit !important;
                    padding: 0 !important;
                    border-radius: 0 !important;
                    font-family: inherit !important;
                    font-weight: inherit !important;
                    line-height: inherit !important;
                    display: inline !important;
                    margin: 0 !important;
                    box-shadow: none !important;
                  }
                  .dark div {
                    color: #60a5fa !important;
                  }
                  #gcvc-for {
                    display: none !important;
                  }
                  #gcvc-by {
                    display: none !important;
                  }
                  #gcvc-views {
                    color: #3b82f6 !important;
                    font-weight: 600 !important;
                  }
                  .dark #gcvc-views {
                    color: #60a5fa !important;
                  }
                `
              });
            } else {
              throw new Error('GoatCounter not available');
            }
          } catch (jsError) {
            console.log('JavaScript API also failed:', jsError);
            const viewsElement = document.getElementById('clean-global-views');
            if (viewsElement) {
              viewsElement.textContent = 'âˆž';
            }
          }
        });
    } catch (error) {
      console.log('Clean global counter error:', error);
    }
  }

  // Initialize when DOM is ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initCleanGlobalCounter);
  } else {
    initCleanGlobalCounter();
  }

  // Add hover effect
  document.addEventListener('DOMContentLoaded', function() {
    const counter = document.getElementById('clean-global-counter');
    if (counter) {
      counter.addEventListener('mouseenter', function() {
        this.style.transform = 'scale(1.05)';
        this.style.transition = 'transform 0.2s ease';
      });
      
      counter.addEventListener('mouseleave', function() {
        this.style.transform = 'scale(1)';
      });
    }
  });
</script>

<style>
  #clean-global-counter {
    transition: all 0.3s ease;
  }
  
  #clean-global-counter:hover {
    transform: scale(1.05);
  }
  
  /* Hide on mobile for better UX */
  @media (max-width: 768px) {
    #clean-global-counter {
      display: none;
    }
  }
</style> 