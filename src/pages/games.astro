---
import Layout from "../layouts/Layout.astro";
import GameCard from "../components/GameCard.astro";

const gamesData = [
  {
    id: "code-snake",
    emoji: "üêç",
    title: "Code Snake: Matrix Edition",
    description:
      "Navigate through the matrix eating code snippets! Features power-ups, portals, ghost mode, and stunning visual effects with matrix rain background.",
    tags: [
      { label: "Canvas 2D", colorClass: "bg-green-600" },
      { label: "Particle Effects", colorClass: "bg-blue-600" },
      { label: "Web Audio API", colorClass: "bg-purple-600" },
      { label: "LocalStorage", colorClass: "bg-orange-600" },
    ],
    features: [
      "Matrix rain background animation",
      "Power-ups: Speed boost, Ghost mode, Portals",
      "Combo system with score multipliers",
      "Smooth animations and particle effects",
    ],
    buttonText: "üêç Enter the Matrix",
    themeClasses: {
      container:
        "bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 border-green-200 dark:border-green-800",
      heading: "text-green-900 dark:text-green-100",
      button: "bg-green-600 hover:bg-green-700",
    },
  },
  {
    id: "dev-memory",
    emoji: "üß†",
    title: "Dev Memory: Code Match",
    description:
      "Match programming languages, dev tools, and code concepts! Beautiful 3D card flips, streak bonuses, and multiple difficulty levels.",
    tags: [
      { label: "CSS 3D Transforms", colorClass: "bg-purple-600" },
      { label: "Animations", colorClass: "bg-pink-600" },
      { label: "DOM Manipulation", colorClass: "bg-blue-600" },
      { label: "Particle System", colorClass: "bg-orange-600" },
    ],
    features: [
      "3 Themes: Languages, Concepts, Tools",
      "Easy (6), Medium (8), Hard (12) pairs",
      "Streak system and combo bonuses",
      "Beautiful card flip animations",
    ],
    buttonText: "üß† Test Your Memory",
    themeClasses: {
      container:
        "bg-gradient-to-br from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20 border-purple-200 dark:border-purple-800",
      heading: "text-purple-900 dark:text-purple-100",
      button: "bg-purple-600 hover:bg-purple-700",
    },
  },
  {
    id: "code-typer",
    emoji: "‚å®Ô∏è",
    title: "Code Typer: Speed Challenge",
    description:
      "Test your coding typing speed! Real code snippets with syntax highlighting, WPM tracking, and accuracy metrics across multiple languages.",
    tags: [
      { label: "Real-time Parsing", colorClass: "bg-cyan-600" },
      { label: "Syntax Highlighting", colorClass: "bg-blue-600" },
      { label: "Performance Metrics", colorClass: "bg-green-600" },
      { label: "LocalStorage", colorClass: "bg-purple-600" },
    ],
    features: [
      "JavaScript, Python, TypeScript snippets",
      "Live syntax highlighting as you type",
      "WPM, accuracy, and error tracking",
      "Easy, Medium, Hard difficulties",
    ],
    buttonText: "‚å®Ô∏è Start Typing",
    themeClasses: {
      container:
        "bg-gradient-to-br from-cyan-50 to-blue-50 dark:from-cyan-900/20 dark:to-blue-900/20 border-cyan-200 dark:border-cyan-800",
      heading: "text-cyan-900 dark:text-cyan-100",
      button: "bg-cyan-600 hover:bg-cyan-700",
    },
  },
  {
    id: "pixel-drawer",
    emoji: "üé®",
    title: "Pixel Sandbox",
    description:
      "Create pixel art or ASCII art in customizable grids. Save, share, and export your creations as JSON or PNG files.",
    tags: [
      { label: "JavaScript ES6", colorClass: "bg-blue-600" },
      { label: "Canvas API", colorClass: "bg-green-600" },
      { label: "File API", colorClass: "bg-purple-600" },
      { label: "Local Storage", colorClass: "bg-orange-600" },
    ],
    features: [
      "Dual mode: Pixel Art & ASCII Art",
      "Multiple grid sizes (16x16 to 48x48)",
      "Export as PNG, JSON, or code snippets",
      "Save/load artwork files",
    ],
    buttonText: "üé® Start Creating",
    themeClasses: {
      container:
        "bg-gradient-to-br from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 border-blue-200 dark:border-blue-800",
      heading: "text-blue-900 dark:text-blue-100",
      button: "bg-blue-600 hover:bg-blue-700",
    },
  },
  {
    id: "useless-machine",
    emoji: "ü§ñ",
    title: "Useless Machine",
    description:
      "An incredibly advanced useless machine with particle effects, sound, thought bubbles, and endless personality! Watch it run away from your cursor, teleport, dance, have tantrums, and perform other delightfully pointless actions.",
    tags: [
      { label: "JavaScript ES6", colorClass: "bg-red-600" },
      { label: "Canvas 2D", colorClass: "bg-blue-600" },
      { label: "Physics", colorClass: "bg-purple-600" },
      { label: "Animation", colorClass: "bg-orange-600" },
    ],
    features: [
      "Particle effects & sound system",
      "Thought bubbles & mood changes",
      "Teleport, dance, tantrums & more",
      "Energy system & enhanced physics",
    ],
    buttonText: "ü§ñ Start Pointless Fun",
    themeClasses: {
      container:
        "bg-gradient-to-br from-red-50 to-pink-50 dark:from-red-900/20 dark:to-pink-900/20 border-red-200 dark:border-red-800",
      heading: "text-red-900 dark:text-red-100",
      button: "bg-red-600 hover:bg-red-700",
    },
  },
  {
    id: "hangman",
    emoji: "üéØ",
    title: "Hangman",
    description:
      "Classic word guessing game re-imagined as a critical system failure. Prevent the server crash by guessing the password before the system is compromised!",
    tags: [
      { label: "JavaScript ES6", colorClass: "bg-green-600" },
      { label: "Canvas 2D", colorClass: "bg-blue-600" },
      { label: "Web Audio API", colorClass: "bg-purple-600" },
      { label: "Local Storage", colorClass: "bg-orange-600" },
    ],
    features: [
      "50+ programming-themed words",
      '"System Failure" visual theme',
      "Sound effects for game events",
      "Score tracking and hints",
    ],
    buttonText: "üéØ Start Playing",
    themeClasses: {
      container:
        "bg-gradient-to-br from-green-50 to-teal-50 dark:from-green-900/20 dark:to-teal-900/20 border-green-200 dark:border-green-800",
      heading: "text-green-900 dark:text-green-100",
      button: "bg-green-600 hover:bg-green-700",
    },
  },
  {
    id: "wack-a-bug",
    emoji: "üêõ",
    title: "Wack a Bug",
    description:
      "A fast-paced bug hunting game! Whack the bugs, avoid the traps, and catch the Golden Bug for bonus points. Features boss battles and splat effects!",
    tags: [
      { label: "JavaScript ES6", colorClass: "bg-yellow-600" },
      { label: "Canvas 2D", colorClass: "bg-blue-600" },
      { label: "Simple Physics", colorClass: "bg-green-600" },
      { label: "Click Detection", colorClass: "bg-orange-600" },
    ],
    features: [
      "Simple one-click gameplay",
      "Golden Bugs & Trap Bugs",
      'Satisfying "Splat" effects',
      "Score tracking and high scores",
      "Increasing difficulty levels",
    ],
    buttonText: "üêõ Start Wacking",
    themeClasses: {
      container:
        "bg-gradient-to-br from-yellow-50 to-orange-50 dark:from-yellow-900/20 dark:to-orange-900/20 border-yellow-200 dark:border-yellow-800",
      heading: "text-yellow-900 dark:text-yellow-100",
      button: "bg-yellow-600 hover:bg-yellow-700",
    },
  },
  {
    id: "typing-test",
    emoji: "‚å®Ô∏è",
    title: "Typing Speed Test",
    description:
      "Test your typing speed with real code snippets! Track your WPM, accuracy, and compete against your best scores.",
    tags: [
      { label: "JavaScript", colorClass: "bg-indigo-600" },
      { label: "Real-time Tracking", colorClass: "bg-violet-600" },
      { label: "LocalStorage", colorClass: "bg-purple-600" },
    ],
    features: [
      "20+ code snippets in various languages",
      "WPM and accuracy tracking",
      "Focus mode for distraction-free typing",
      "Personal best score tracking",
    ],
    buttonText: "‚å®Ô∏è Start Typing",
    themeClasses: {
      container:
        "bg-gradient-to-br from-indigo-50 to-violet-50 dark:from-indigo-900/20 dark:to-violet-900/20 border-indigo-200 dark:border-indigo-800",
      heading: "text-indigo-900 dark:text-indigo-100",
      button: "bg-indigo-600 hover:bg-indigo-700",
    },
  },
  {
    id: "dev-bingo",
    emoji: "üéØ",
    title: "Developer Bingo",
    description:
      "The classic bingo game with a developer twist! Mark off relatable dev experiences and share your card with friends.",
    tags: [
      { label: "JavaScript", colorClass: "bg-pink-600" },
      { label: "CSS Grid", colorClass: "bg-rose-600" },
      { label: "LocalStorage", colorClass: "bg-red-600" },
    ],
    features: [
      "45+ relatable developer situations",
      "Win detection for rows, columns, diagonals",
      "Share your bingo card",
      "Progress saved automatically",
    ],
    buttonText: "üéØ Play Bingo",
    themeClasses: {
      container:
        "bg-gradient-to-br from-pink-50 to-rose-50 dark:from-pink-900/20 dark:to-rose-900/20 border-pink-200 dark:border-pink-800",
      heading: "text-pink-900 dark:text-pink-100",
      button: "bg-pink-600 hover:bg-pink-700",
    },
  },
  {
    id: "emoji-clicker",
    emoji: "üé™",
    title: "Emoji Clicker",
    description:
      "Click falling emojis as fast as you can! Level up, increase your multiplier, and get the highest score in 30 seconds. Simple but incredibly addictive!",
    tags: [
      { label: "Vanilla JS", colorClass: "bg-yellow-600" },
      { label: "Game Loop", colorClass: "bg-orange-600" },
      { label: "Event Handling", colorClass: "bg-red-600" },
      { label: "Animation", colorClass: "bg-pink-600" },
    ],
    features: [
      "30-second time limit",
      "Progressive difficulty levels",
      "Multiplier system",
      "Floating score indicators",
    ],
    buttonText: "üé™ Click Away!",
    themeClasses: {
      container:
        "bg-gradient-to-br from-yellow-50 to-orange-50 dark:from-yellow-900/20 dark:to-orange-900/20 border-yellow-200 dark:border-yellow-800",
      heading: "text-yellow-900 dark:text-yellow-100",
      button: "bg-yellow-600 hover:bg-yellow-700",
    },
  },
];
---

<Layout
  title="Games - Mangesh"
  description="Simple games and interactive tools - Pixel Sandbox, ASCII Drawer, Hangman and more"
>
  <div class="max-w-6xl mx-auto px-4 py-12">
    <!-- Header -->
    <div class="text-center mb-12">
      <h1 class="text-4xl font-bold mb-4 custom-gradient-text">
        üéÆ Interactive Games
      </h1>
      <p class="text-lg text-gray-600 dark:text-gray-400 max-w-2xl mx-auto">
        Collection of interactive games and creative tools built with modern web
        technologies. Click on any game to start playing!
      </p>
    </div>

        <!-- Games Grid -->
    <div class="grid md:grid-cols-2 gap-8 mb-12">
      {
        gamesData.map((game) => (
          <GameCard
            id={game.id}
            title={game.title}
            emoji={game.emoji}
            description={game.description}
            tags={game.tags}
            features={game.features}
            buttonText={game.buttonText}
            themeClasses={game.themeClasses}
          />
        ))
      }
    </div>

    <!-- Game Container -->
    <div id="game-container" class="hidden">
      <div
        class="bg-white dark:bg-gray-800 rounded-xl p-8 border border-gray-200 dark:border-gray-700"
      >
        <div class="flex justify-between items-center mb-6">
          <h2 id="game-title" class="text-2xl font-bold"></h2>
          <button
            onclick="hideGame()"
            class="px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors"
          >
            ‚Üê Back to Games
          </button>
        </div>

        <!-- Pixel Drawer Game -->
        <div id="pixel-drawer-game" class="game-content hidden"></div>

        <!-- Hangman Game -->
        <div id="hangman-game" class="game-content hidden"></div>

        <!-- Useless Machine Game -->
        <div id="useless-machine-game" class="game-content hidden">
          <style>
            #useless-machine-canvas {
              box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);
              transition: all 0.3s ease;
            }

            #useless-machine-canvas:hover {
              box-shadow: 0 0 50px rgba(255, 255, 255, 0.1);
            }

            #status {
              font-family: "Courier New", monospace;
              font-weight: bold;
              min-height: 3rem;
              display: flex;
              align-items: center;
              justify-content: center;
            }

            .useless-machine-controls button {
              transition: all 0.2s ease;
              transform: scale(1);
            }

            .useless-machine-controls button:hover {
              transform: scale(1.05);
            }

            .useless-machine-controls button:active {
              transform: scale(0.95);
            }
          </style>
        </div>

        <!-- Wack a Bug Game -->
        <div id="wack-a-bug-game" class="game-content hidden">
          <style>
            #wack-a-bug-canvas {
              box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
              transition: all 0.3s ease;
              cursor: crosshair;
            }

            #wack-a-bug-canvas:hover {
              box-shadow: 0 0 30px rgba(255, 193, 7, 0.2);
            }

            .wack-a-bug-controls button {
              transition: all 0.2s ease;
              transform: scale(1);
            }

            .wack-a-bug-controls button:hover {
              transform: scale(1.05);
            }

            .wack-a-bug-controls button:active {
              transform: scale(0.95);
            }
          </style>
        </div>

        <!-- Code Snake Game -->
        <div id="code-snake-game" class="game-content hidden"></div>

        <!-- Dev Memory Game -->
        <div id="dev-memory-game" class="game-content hidden"></div>

        <!-- Code Typer Game -->
        <div id="code-typer-game" class="game-content hidden"></div>

        <!-- Typing Test Game -->
        <div id="typing-test-game" class="game-content hidden"></div>

        <!-- Dev Bingo Game -->
        <div id="dev-bingo-game" class="game-content hidden"></div>
      </div>
    </div>

    <!-- More Games Section (Placeholder) -->
    <section class="text-center">
      <div
        class="bg-gradient-to-r from-yellow-50 to-orange-50 dark:from-yellow-900/20 dark:to-orange-900/20 rounded-lg p-8 border border-yellow-200 dark:border-yellow-800"
      >
        <h2 class="text-2xl font-bold mb-4">üéÆ 9 Games Available!</h2>
        <p class="text-gray-600 dark:text-gray-400 mb-4">
          From coding challenges to creative tools - each game features unique
          mechanics, beautiful animations, and hours of fun!
        </p>
        <div class="grid md:grid-cols-3 gap-4 mt-6">
          <div
            class="bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700"
          >
            <div class="text-2xl mb-2">üéØ</div>
            <h3 class="font-semibold">More Coming Soon</h3>
            <p class="text-sm text-gray-600 dark:text-gray-400">
              Got ideas? Let me know!
            </p>
          </div>
          <div
            class="bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700"
          >
            <div class="text-2xl mb-2">‚ö°</div>
            <h3 class="font-semibold">All Games Free</h3>
            <p class="text-sm text-gray-600 dark:text-gray-400">
              No ads, no tracking, pure fun
            </p>
          </div>
          <div
            class="bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700"
          >
            <div class="text-2xl mb-2">üíæ</div>
            <h3 class="font-semibold">High Scores Saved</h3>
            <p class="text-sm text-gray-600 dark:text-gray-400">
              Track your progress locally
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- Hidden elements for functionality -->
    <input
      type="file"
      id="json-file-input"
      accept=".json"
      style="display: none;"
    />
    <canvas id="download-canvas" style="display: none;"></canvas>
  </div>

  <script>
    // Type definitions
    interface GameInstance {
      destroy?: () => void;
    }

    type GameConstructor = new () => GameInstance;

    // Game management functions
    let currentGame: GameInstance | null = null;

    // Extend window interface for global functions
    interface GameWindow extends Window {
      PixelStudio?: GameConstructor;
      ChaosMachine?: GameConstructor;
      BugBlaster?: GameConstructor;
      CodeSnake?: GameConstructor;
      DevMemory?: GameConstructor;
      CodeTyper?: GameConstructor;
      CodeHangman?: GameConstructor;
      TypingTest?: GameConstructor;
      DevBingo?: GameConstructor;
      showGame?: (gameType: string) => void;
      hideGame?: () => void;
    }

    function showGame(gameType: string) {
      const gameContainer = document.getElementById("game-container");
      const gameTitle = document.getElementById("game-title");

      if (!gameContainer || !gameTitle) return;

      // Cleanup previous game
      if (currentGame && typeof currentGame.destroy === "function") {
        currentGame.destroy();
        currentGame = null;
      }

      // Hide all game content
      document.querySelectorAll(".game-content").forEach((content) => {
        content.classList.add("hidden");
      });

      if (gameType === "pixel-drawer") {
        gameTitle.textContent = "üé® Pixel Sandbox / ASCII Drawer";
        const gameContent = document.getElementById("pixel-drawer-game");
        if (!gameContent) return;

        gameContent.innerHTML = `
          <!-- Game Controls -->
          <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-6 mb-6">
            <div class="grid md:grid-cols-4 gap-4 mb-6">
              <div>
                <label class="flex items-center space-x-2">
                  <input type="checkbox" id="mode-toggle" class="form-checkbox">
                  <span class="text-sm font-medium">ASCII Mode</span>
                </label>
              </div>
              
              <div>
                <label for="grid-size" class="block text-sm font-medium mb-2">Grid Size</label>
                <input type="range" id="grid-size" min="16" max="48" value="32" class="w-full">
                <span id="grid-size-value" class="text-sm text-gray-600">32√ó32</span>
              </div>

              <div>
                <label for="color-picker" class="block text-sm font-medium mb-2">Color</label>
                <input type="color" id="color-picker" value="#000000" class="w-full h-10 border border-gray-300 dark:border-gray-600 rounded-md">
              </div>

              <div>
                <label for="char-selector" class="block text-sm font-medium mb-2">Character</label>
                <select id="char-selector" class="w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700">
                  <!-- Options will be populated by JavaScript -->
                </select>
              </div>
            </div>

            <div class="flex flex-wrap gap-3">
              <div class="flex gap-2 mr-2">
                <button id="tool-brush" class="px-3 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors active ring-2 ring-offset-2 ring-blue-500">
                  üñåÔ∏è Brush
                </button>
                <button id="tool-bucket" class="px-3 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors">
                  ü™£ Fill
                </button>
                <button id="tool-eraser" class="px-3 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors">
                  üßπ Eraser
                </button>
              </div>
              <button id="clear-btn" class="px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors">
                Clear
              </button>
              <button id="save-json-btn" class="px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors">
                Save
              </button>
              <button id="load-json-btn" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors">
                Load
              </button>
              <button id="export-code-btn" class="px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition-colors">
                Code
              </button>
              <button id="download-png-btn" class="px-4 py-2 bg-orange-600 text-white rounded-md hover:bg-orange-700 transition-colors">
                PNG
              </button>
              <button id="copy-ascii-btn" class="px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors">
                ASCII
              </button>
            </div>
          </div>

          <!-- Drawing Canvas -->
          <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-6 mb-6">
            <div class="flex justify-center">
              <canvas id="pixel-canvas" class="border-2 border-gray-400 dark:border-gray-600 bg-white cursor-crosshair"></canvas>
            </div>
          </div>

          <!-- ASCII Output -->
          <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-6">
            <h3 class="text-lg font-semibold mb-4">ASCII Preview</h3>
            <pre id="ascii-preview" class="font-mono text-sm bg-white dark:bg-gray-900 p-4 rounded border overflow-auto max-h-64 whitespace-pre"></pre>
          </div>

          <!-- Hidden file input for loading -->
          <input type="file" id="json-file-input" accept=".json" style="display: none;">
        `;
        gameContent.classList.remove("hidden");

        // Load and initialize pixel studio
        const gameWindow = window as GameWindow;
        if (gameWindow.PixelStudio) {
          currentGame = new gameWindow.PixelStudio();
        } else {
          loadScript("/game-scripts/pixel-drawer.js", () => {
            if (gameWindow.PixelStudio) {
              currentGame = new gameWindow.PixelStudio();
            }
          });
        }
      } else if (gameType === "useless-machine") {
        gameTitle.textContent = "ü§ñ Useless Machine";
        const gameContent = document.getElementById("useless-machine-game");
        if (!gameContent) return;

        gameContent.innerHTML = `
          <!-- Game Area -->
          <div class="flex flex-col items-center">
            <!-- Useless Machine Drawing -->
            <div class="mb-6">
              <canvas id="useless-machine-canvas" width="500" height="350" class="border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-900 cursor-crosshair"></canvas>
            </div>

            <!-- Game Controls -->
            <div class="w-full max-w-md">
              <h3 class="text-lg font-semibold mb-4 text-center">Click to interact:</h3>
              <div class="flex flex-wrap justify-center gap-2 mb-4 useless-machine-controls">
                <button id="start-btn" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors">
                  üöÄ Start
                </button>
                <button id="stop-btn" class="px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors">
                  ‚èπÔ∏è Stop
                </button>
                <button id="reset-btn" class="px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors">
                  ‚Ü©Ô∏è Reset
                </button>
              </div>
              
              <!-- Status Display -->
              <div id="status" class="text-center p-3 bg-gray-100 dark:bg-gray-700 rounded-lg mb-4">
                Ready to be useless!
              </div>
              
              <!-- Energy Display -->
              <div class="text-center mb-4">
                <div class="text-sm text-gray-600 dark:text-gray-400 mb-1">Energy Level</div>
                <div class="w-full bg-gray-200 dark:bg-gray-600 rounded-full h-3">
                  <div id="energy-bar" class="bg-green-500 h-3 rounded-full transition-all duration-300" style="width: 100%"></div>
                </div>
                <div id="energy-text" class="text-xs text-gray-500 dark:text-gray-400 mt-1">100%</div>
              </div>
              
              <!-- Emotion Buttons -->
              <div class="mb-4">
                <h4 class="text-sm font-semibold mb-2 text-center">Force Emotions:</h4>
                <div class="grid grid-cols-4 gap-2">
                  <button id="emotion-happy" class="px-2 py-1 bg-green-500 text-white text-xs rounded hover:bg-green-600 transition-colors">
                    üòä Happy
                  </button>
                  <button id="emotion-sad" class="px-2 py-1 bg-blue-500 text-white text-xs rounded hover:bg-blue-600 transition-colors">
                    üò¢ Sad
                  </button>
                  <button id="emotion-angry" class="px-2 py-1 bg-red-500 text-white text-xs rounded hover:bg-red-600 transition-colors">
                    üò† Angry
                  </button>
                  <button id="emotion-confused" class="px-2 py-1 bg-purple-500 text-white text-xs rounded hover:bg-purple-600 transition-colors">
                    üòµ Confused
                  </button>
                </div>
                <div class="grid grid-cols-4 gap-2 mt-2">
                  <button id="emotion-scared" class="px-2 py-1 bg-yellow-500 text-white text-xs rounded hover:bg-yellow-600 transition-colors">
                    üò® Scared
                  </button>
                  <button id="emotion-tired" class="px-2 py-1 bg-gray-500 text-white text-xs rounded hover:bg-gray-600 transition-colors">
                    üò¥ Tired
                  </button>
                  <button id="emotion-neutral" class="px-2 py-1 bg-gray-400 text-white text-xs rounded hover:bg-gray-500 transition-colors">
                    üòê Neutral
                  </button>
                  <button id="emotion-random" class="px-2 py-1 bg-pink-500 text-white text-xs rounded hover:bg-pink-600 transition-colors">
                    üé≤ Random
                  </button>
                </div>
              </div>
              
              <!-- Enhanced Instructions -->
              <div class="text-sm text-gray-600 dark:text-gray-400 space-y-2 mb-4">
                <p><strong>üéÆ Controls:</strong></p>
                <ul class="space-y-1 ml-4">
                  <li>‚Ä¢ <strong>Click</strong> to trigger random useless actions</li>
                  <li>‚Ä¢ <strong>Double-click</strong> to trigger a tantrum!</li>
                  <li>‚Ä¢ <strong>Move mouse</strong> near the machine to watch it run away</li>
                  <li>‚Ä¢ <strong>Watch</strong> for thought bubbles and mood changes</li>
                  <li>‚Ä¢ <strong>Use emotion buttons</strong> to force specific moods</li>
                </ul>
              </div>
            </div>
          </div>

          <!-- Instructions -->
          <div class="mt-6 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg">
            <h3 class="font-semibold mb-2">üéØ What This Machine Does (Absolutely Nothing Useful!):</h3>
            <ul class="text-sm text-gray-600 dark:text-gray-400 space-y-1">
              <li>‚Ä¢ <strong>Runs away</strong> from your mouse cursor like a scared robot</li>
              <li>‚Ä¢ <strong>Turns itself off</strong> when you try to interact with it</li>
              <li>‚Ä¢ <strong>Performs random actions:</strong> spin, bounce, shake, hide, teleport, dance, shrink, grow, sleep, protest, malfunction, glitch, gravity switch, and more!</li>
              <li>‚Ä¢ <strong>Changes mood and color</strong> based on its current state</li>
              <li>‚Ä¢ <strong>Shows thought bubbles</strong> with amusing messages</li>
              <li>‚Ä¢ <strong>Creates particle effects</strong> for visual flair</li>
              <li>‚Ä¢ <strong>Has an energy system</strong> that affects its behavior</li>
              <li>‚Ä¢ <strong>Completely pointless</strong> but endlessly entertaining!</li>
            </ul>
          </div>
        `;
        gameContent.classList.remove("hidden");

        // Load and initialize chaos machine
        const gameWindow = window as GameWindow;
        if (gameWindow.ChaosMachine) {
          currentGame = new gameWindow.ChaosMachine();
        } else {
          loadScript("/game-scripts/useless-machine.js", () => {
            if (gameWindow.ChaosMachine) {
              const ChaosMachineClass = gameWindow.ChaosMachine;
              // Add a slight delay to ensure DOM is fully ready
              setTimeout(() => {
                currentGame = new ChaosMachineClass();
              }, 100);
            }
          });
        }
      } else if (gameType === "wack-a-bug") {
        gameTitle.textContent = "üêõ Wack a Bug";
        const gameContent = document.getElementById("wack-a-bug-game");
        if (!gameContent) return;

        gameContent.innerHTML = `
          <!-- Game Area -->
          <div class="flex flex-col items-center">
            <!-- Wack a Bug Canvas -->
            <div class="mb-6">
              <canvas id="wack-a-bug-canvas" width="500" height="400" class="border border-gray-300 dark:border-gray-600 rounded-lg bg-gradient-to-b from-green-50 to-green-100 dark:from-green-900 dark:to-green-800"></canvas>
            </div>

            <!-- Game Controls -->
            <div class="w-full max-w-md">
              <h3 class="text-lg font-semibold mb-4 text-center">üêõ Bug Wacking Fun!</h3>
              
              <!-- Score Display -->
              <div class="grid grid-cols-2 gap-4 mb-4">
                <div class="text-center p-3 bg-yellow-100 dark:bg-yellow-900/20 rounded-lg">
                  <div class="text-2xl font-bold text-yellow-600" id="score">0</div>
                  <div class="text-sm text-gray-600 dark:text-gray-400">Score</div>
                </div>
                <div class="text-center p-3 bg-blue-100 dark:bg-blue-900/20 rounded-lg">
                  <div class="text-2xl font-bold text-blue-600" id="high-score">0</div>
                  <div class="text-sm text-gray-600 dark:text-gray-400">High Score</div>
                </div>
              </div>
              
              <!-- Game Controls -->
              <div class="flex flex-wrap justify-center gap-2 mb-4 wack-a-bug-controls">
                <button id="start-game-btn" class="px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors">
                  üöÄ Start Game
                </button>
                <button id="pause-game-btn" class="px-4 py-2 bg-yellow-600 text-white rounded-md hover:bg-yellow-700 transition-colors">
                  ‚è∏Ô∏è Pause
                </button>
                <button id="reset-game-btn" class="px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors">
                  üîÑ Reset
                </button>
              </div>
              
              <!-- Game Status -->
              <div id="game-status" class="text-center p-3 bg-gray-100 dark:bg-gray-700 rounded-lg mb-4">
                Click Start Game to begin!
              </div>
              
              <!-- Instructions -->
              <div class="text-sm text-gray-600 dark:text-gray-400 space-y-2 text-center">
                <p><strong>üéØ How to Play:</strong></p>
                <ul class="space-y-1">
                  <li>‚Ä¢ Click bugs as they appear to score points</li>
                  <li>‚Ä¢ <strong>Golden Bugs</strong> give bonus points!</li>
                  <li>‚Ä¢ <strong>Avoid Trap Bugs</strong> (dark grey) or lose health!</li>
                  <li>‚Ä¢ Defeat the Boss every 5 waves!</li>
                </ul>
              </div>
            </div>
          </div>
        `;
        gameContent.classList.remove("hidden");

        // Load and initialize bug blaster
        const gameWindow = window as GameWindow;
        if (gameWindow.BugBlaster) {
          currentGame = new gameWindow.BugBlaster();
        } else {
          loadScript("/game-scripts/wack-a-bug.js", () => {
            if (gameWindow.BugBlaster) {
              const BugBlasterClass = gameWindow.BugBlaster;
              // Add a slight delay to ensure DOM is fully ready
              setTimeout(() => {
                currentGame = new BugBlasterClass();
              }, 100);
            }
          });
        }
      } else if (gameType === "code-snake") {
        gameTitle.textContent = "üêç Code Snake: Matrix Edition";
        const gameContent = document.getElementById("code-snake-game");
        if (!gameContent) return;

        gameContent.innerHTML = `
          <div class="flex flex-col items-center">
            <canvas id="snake-canvas" width="500" height="500" class="border-2 border-green-600 dark:border-green-400 rounded-lg shadow-2xl mb-6"></canvas>

            <div class="w-full max-w-2xl">
              <!-- Stats -->
              <div class="grid grid-cols-4 gap-3 mb-4">
                <div class="text-center p-3 bg-green-100 dark:bg-green-900/20 rounded-lg">
                  <div class="text-xl font-bold text-green-600" id="snake-score">0</div>
                  <div class="text-xs text-gray-600 dark:text-gray-400">Score</div>
                </div>
                <div class="text-center p-3 bg-blue-100 dark:bg-blue-900/20 rounded-lg">
                  <div class="text-xl font-bold text-blue-600" id="snake-high-score">0</div>
                  <div class="text-xs text-gray-600 dark:text-gray-400">High Score</div>
                </div>
                <div class="text-center p-3 bg-purple-100 dark:bg-purple-900/20 rounded-lg">
                  <div class="text-xl font-bold text-purple-600" id="snake-level">1</div>
                  <div class="text-xs text-gray-600 dark:text-gray-400">Level</div>
                </div>
                <div class="text-center p-3 bg-orange-100 dark:bg-orange-900/20 rounded-lg">
                  <div class="text-xl font-bold text-orange-600" id="snake-length">5</div>
                  <div class="text-xs text-gray-600 dark:text-gray-400">Length</div>
                </div>
              </div>

              <!-- Controls -->
              <div class="flex flex-wrap justify-center gap-2 mb-4">
                <button id="start-snake-btn" class="px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700">üöÄ Start</button>
                <button id="pause-snake-btn" class="px-4 py-2 bg-yellow-600 text-white rounded-md hover:bg-yellow-700">‚è∏Ô∏è Pause</button>
                <button id="reset-snake-btn" class="px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700">üîÑ Reset</button>
              </div>

              <!-- Arrow Controls for Mobile -->
              <div class="flex justify-center mb-4">
                <div class="grid grid-cols-3 gap-1 w-32">
                  <div></div>
                  <button id="snake-up" class="bg-gray-700 hover:bg-gray-600 text-white p-2 rounded">‚Üë</button>
                  <div></div>
                  <button id="snake-left" class="bg-gray-700 hover:bg-gray-600 text-white p-2 rounded">‚Üê</button>
                  <div></div>
                  <button id="snake-right" class="bg-gray-700 hover:bg-gray-600 text-white p-2 rounded">‚Üí</button>
                  <div></div>
                  <button id="snake-down" class="bg-gray-700 hover:bg-gray-600 text-white p-2 rounded">‚Üì</button>
                  <div></div>
                </div>
              </div>

              <div id="snake-status" class="text-center p-3 bg-gray-100 dark:bg-gray-700 rounded-lg text-sm">Press SPACE or click Start to begin!</div>

              <div class="mt-4 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg text-sm">
                <p class="font-semibold mb-2">üéÆ How to Play:</p>
                <ul class="space-y-1 text-gray-600 dark:text-gray-400">
                  <li>‚Ä¢ Use arrow keys, WASD, or buttons to move</li>
                  <li>‚Ä¢ Eat code snippets to grow and score points</li>
                  <li>‚Ä¢ Collect power-ups: Speed ‚ö°, Ghost üëª, Portals üåÄ</li>
                  <li>‚Ä¢ Build combos for bonus points!</li>
                </ul>
              </div>
            </div>
          </div>
        `;
        gameContent.classList.remove("hidden");
        const gameWindow = window as GameWindow;
        if (gameWindow.CodeSnake) {
          currentGame = new gameWindow.CodeSnake();
        } else {
          loadScript("/game-scripts/code-snake.js", () => {
            if (gameWindow.CodeSnake) {
              const CodeSnakeClass = gameWindow.CodeSnake;
              setTimeout(() => {
                currentGame = new CodeSnakeClass();
              }, 100);
            }
          });
        }
      } else if (gameType === "dev-memory") {
        gameTitle.textContent = "üß† Dev Memory: Code Match";
        const gameContent = document.getElementById("dev-memory-game");
        if (!gameContent) return;

        gameContent.innerHTML = `
          <style>
            .memory-grid { display: grid; gap: 1rem; margin: 2rem auto; max-width: 600px; }
            .memory-grid-easy { grid-template-columns: repeat(3, 1fr); }
            .memory-grid-medium { grid-template-columns: repeat(4, 1fr); }
            .memory-grid-hard { grid-template-columns: repeat(4, 1fr); }

            .memory-card { aspect-ratio: 1; cursor: pointer; perspective: 1000px; }
            .memory-card-inner { position: relative; width: 100%; height: 100%; transition: transform 0.6s; transform-style: preserve-3d; }
            .memory-card.flipped .memory-card-inner { transform: rotateY(180deg); }
            .memory-card.matched .memory-card-inner { opacity: 0.7; transform: scale(0.95); }

            .memory-card-front, .memory-card-back {
              position: absolute; width: 100%; height: 100%; backface-visibility: hidden;
              border-radius: 12px; display: flex; flex-direction: column; align-items: center; justify-content: center;
              box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            }

            .memory-card-front { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
            .memory-card-back { transform: rotateY(180deg); }
            .card-pattern { position: absolute; top: 0; left: 0; right: 0; bottom: 0; opacity: 0.1;
              background: repeating-linear-gradient(45deg, transparent, transparent 10px, white 10px, white 20px); }
            .card-logo { font-size: 2rem; color: white; font-weight: bold; }
            .card-emoji { font-size: 2.5rem; margin-bottom: 0.5rem; }
            .card-content { font-size: 0.75rem; font-weight: bold; color: white; text-align: center; }

            .memory-particle {
              position: absolute; width: 6px; height: 6px; border-radius: 50%; pointer-events: none;
              animation: particle-float 1s ease-out forwards;
            }

            @keyframes particle-float {
              to { transform: translate(var(--vx), var(--vy)); opacity: 0; }
            }

            .active { ring: 2px; ring-color: blue; background-color: blue !important; }
          </style>

          <div class="max-w-4xl mx-auto">
            <!-- Stats -->
            <div class="grid grid-cols-5 gap-3 mb-4">
              <div class="text-center p-3 bg-purple-100 dark:bg-purple-900/20 rounded-lg">
                <div class="text-xl font-bold text-purple-600" id="memory-score">0</div>
                <div class="text-xs">Score</div>
              </div>
              <div class="text-center p-3 bg-blue-100 dark:bg-blue-900/20 rounded-lg">
                <div class="text-xl font-bold text-blue-600" id="memory-moves">0</div>
                <div class="text-xs">Moves</div>
              </div>
              <div class="text-center p-3 bg-green-100 dark:bg-green-900/20 rounded-lg">
                <div class="text-xl font-bold text-green-600" id="memory-matches">0/0</div>
                <div class="text-xs">Matches</div>
              </div>
              <div class="text-center p-3 bg-orange-100 dark:bg-orange-900/20 rounded-lg">
                <div class="text-xl font-bold text-orange-600" id="memory-streak">0</div>
                <div class="text-xs">Streak</div>
              </div>
              <div class="text-center p-3 bg-pink-100 dark:bg-pink-900/20 rounded-lg">
                <div class="text-xl font-bold text-pink-600" id="memory-time">--</div>
                <div class="text-xs">Time</div>
              </div>
            </div>

            <!-- Controls -->
            <div class="flex flex-wrap gap-2 mb-4">
              <div class="flex gap-2">
                <button data-difficulty="easy" class="px-3 py-1 bg-green-600 text-white rounded-md hover:bg-green-700 text-sm">Easy</button>
                <button data-difficulty="medium" class="px-3 py-1 bg-yellow-600 text-white rounded-md hover:bg-yellow-700 text-sm active">Medium</button>
                <button data-difficulty="hard" class="px-3 py-1 bg-red-600 text-white rounded-md hover:bg-red-700 text-sm">Hard</button>
              </div>
              <div class="flex gap-2">
                <button data-theme="languages" class="px-3 py-1 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-sm active">Languages</button>
                <button data-theme="concepts" class="px-3 py-1 bg-purple-600 text-white rounded-md hover:bg-purple-700 text-sm">Concepts</button>
                <button data-theme="tools" class="px-3 py-1 bg-pink-600 text-white rounded-md hover:bg-pink-700 text-sm">Tools</button>
              </div>
              <div class="flex gap-2 ml-auto">
                <button id="start-memory-btn" class="px-4 py-1 bg-green-600 text-white rounded-md hover:bg-green-700 text-sm">üöÄ Start</button>
                <button id="reset-memory-btn" class="px-4 py-1 bg-red-600 text-white rounded-md hover:bg-red-700 text-sm">üîÑ Reset</button>
              </div>
            </div>

            <!-- Game Container -->
            <div id="memory-game-container" style="position: relative; min-height: 400px;"></div>

            <div id="memory-status" class="text-center p-3 bg-gray-100 dark:bg-gray-700 rounded-lg text-sm mt-4">
              Select difficulty and theme to start!
            </div>
          </div>
        `;
        gameContent.classList.remove("hidden");
        const gameWindow = window as GameWindow;
        if (gameWindow.DevMemory) {
          currentGame = new gameWindow.DevMemory();
        } else {
          loadScript("/game-scripts/dev-memory.js", () => {
            if (gameWindow.DevMemory) {
              const DevMemoryClass = gameWindow.DevMemory;
              setTimeout(() => {
                currentGame = new DevMemoryClass();
              }, 100);
            }
          });
        }
      } else if (gameType === "code-typer") {
        gameTitle.textContent = "‚å®Ô∏è Code Typer: Speed Challenge";
        const gameContent = document.getElementById("code-typer-game");
        if (!gameContent) return;

        gameContent.innerHTML = `
          <style>
            #code-display {
              font-family: 'Courier New', monospace; font-size: 18px; line-height: 1.8; padding: 1.5rem;
              background: #1e293b; color: #e2e8f0; border-radius: 8px; min-height: 120px;
              overflow-wrap: break-word; word-wrap: break-word;
            }
            #code-display span { transition: all 0.1s; }
            #code-display .correct { color: #10b981; }
            #code-display .incorrect { color: #ef4444; background: #7f1d1d; }
            #code-display .current { background: #3b82f6; color: white; }
            #code-display .syntax-keyword { color: #c084fc; font-weight: bold; }
            #code-display .syntax-string { color: #fbbf24; }
            #code-display .syntax-number { color: #60a5fa; }
            #code-display .syntax-operator { color: #fb923c; }
            #code-display .syntax-bracket { color: #a78bfa; }

            #typing-input {
              font-family: 'Courier New', monospace; font-size: 16px; padding: 1rem;
              border: 2px solid #3b82f6; border-radius: 8px; width: 100%;
              background: #0f172a; color: #e2e8f0;
            }
            #typing-input:focus { outline: none; border-color: #60a5fa; box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1); }

            .typing-confetti {
              position: absolute; width: 8px; height: 8px; border-radius: 50%;
              animation: confetti-fall 2s ease-out forwards; pointer-events: none;
            }
            @keyframes confetti-fall {
              to { transform: translateY(400px) rotate(360deg); opacity: 0; }
            }
          </style>

          <div class="max-w-4xl mx-auto typing-container" style="position: relative;">
            <!-- Stats -->
            <div class="grid grid-cols-5 gap-3 mb-4">
              <div class="text-center p-3 bg-cyan-100 dark:bg-cyan-900/20 rounded-lg">
                <div class="text-xl font-bold text-cyan-600" id="typer-wpm">0</div>
                <div class="text-xs">WPM</div>
              </div>
              <div class="text-center p-3 bg-green-100 dark:bg-green-900/20 rounded-lg">
                <div class="text-xl font-bold text-green-600" id="typer-accuracy">100%</div>
                <div class="text-xs">Accuracy</div>
              </div>
              <div class="text-center p-3 bg-red-100 dark:bg-red-900/20 rounded-lg">
                <div class="text-xl font-bold text-red-600" id="typer-errors">0</div>
                <div class="text-xs">Errors</div>
              </div>
              <div class="text-center p-3 bg-purple-100 dark:bg-purple-900/20 rounded-lg">
                <div class="text-xl font-bold text-purple-600" id="typer-time">0.0s</div>
                <div class="text-xs">Time</div>
              </div>
              <div class="text-center p-3 bg-orange-100 dark:bg-orange-900/20 rounded-lg">
                <div class="text-xl font-bold text-orange-600" id="typer-best">0</div>
                <div class="text-xs">Best WPM</div>
              </div>
            </div>

            <!-- Controls -->
            <div class="flex flex-wrap gap-2 mb-4">
              <div class="flex gap-2">
                <button data-language="javascript" class="px-3 py-1 bg-yellow-600 text-white rounded-md hover:bg-yellow-700 text-sm active">JavaScript</button>
                <button data-language="python" class="px-3 py-1 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-sm">Python</button>
                <button data-language="typescript" class="px-3 py-1 bg-blue-700 text-white rounded-md hover:bg-blue-800 text-sm">TypeScript</button>
              </div>
              <div class="flex gap-2">
                <button data-diff="easy" class="px-3 py-1 bg-green-600 text-white rounded-md hover:bg-green-700 text-sm">Easy</button>
                <button data-diff="medium" class="px-3 py-1 bg-yellow-600 text-white rounded-md hover:bg-yellow-700 text-sm active">Medium</button>
                <button data-diff="hard" class="px-3 py-1 bg-red-600 text-white rounded-md hover:bg-red-700 text-sm">Hard</button>
              </div>
              <div class="flex gap-2 ml-auto">
                <button id="new-snippet-btn" class="px-3 py-1 bg-purple-600 text-white rounded-md hover:bg-purple-700 text-sm">üîÑ New</button>
                <button id="start-typer-btn" class="px-4 py-1 bg-green-600 text-white rounded-md hover:bg-green-700 text-sm">üöÄ Start</button>
                <button id="reset-typer-btn" class="px-4 py-1 bg-red-600 text-white rounded-md hover:bg-red-700 text-sm">‚Ü©Ô∏è Reset</button>
              </div>
            </div>

            <!-- Code Display -->
            <div id="code-display" class="mb-4"></div>

            <!-- Input Area -->
            <textarea id="typing-input" rows="3" placeholder="Focus here to start typing..." disabled></textarea>

            <div id="typer-status" class="text-center p-3 bg-gray-100 dark:bg-gray-700 rounded-lg text-sm mt-4">
              Click Start or focus input to begin!
            </div>
          </div>
        `;
        gameContent.classList.remove("hidden");
        const gameWindow = window as GameWindow;
        if (gameWindow.CodeTyper) {
          currentGame = new gameWindow.CodeTyper();
        } else {
          loadScript("/game-scripts/code-typer.js", () => {
            if (gameWindow.CodeTyper) {
              const CodeTyperClass = gameWindow.CodeTyper;
              setTimeout(() => {
                currentGame = new CodeTyperClass();
              }, 100);
            }
          });
        }
      } else if (gameType === "hangman") {
        gameTitle.textContent = "üéØ Hangman Game";
        const gameContent = document.getElementById("hangman-game");
        if (!gameContent) return;

        gameContent.innerHTML = `
          <!-- Game Stats -->
          <div class="grid md:grid-cols-3 gap-4 mb-6">
            <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4 text-center">
              <div class="text-2xl font-bold" id="score">Wins: 0 | Losses: 0</div>
              <div class="text-sm text-gray-600 dark:text-gray-400">Score</div>
            </div>
            <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4 text-center">
              <div class="text-2xl font-bold" id="wrong-guesses">0/6</div>
              <div class="text-sm text-gray-600 dark:text-gray-400">Wrong Guesses</div>
            </div>
            <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4 text-center">
              <div class="text-sm" id="guessed-letters">None</div>
              <div class="text-sm text-gray-600 dark:text-gray-400">Guessed Letters</div>
            </div>
          </div>

          <!-- Game Status -->
          <div class="text-center mb-6">
            <div id="game-status" class="text-lg mb-4">‚ö†Ô∏è SYSTEM FAILURE IMMINENT. RESTORE PASSWORD.</div>
            <div id="word-display" class="text-4xl font-mono font-bold tracking-widest mb-6">_ _ _ _ _</div>
          </div>

          <!-- Game Area -->
          <div class="grid md:grid-cols-2 gap-8">
            <!-- Hangman Drawing -->
            <div class="flex justify-center">
              <canvas id="hangman-canvas" width="300" height="250" class="border border-gray-300 dark:border-gray-600 rounded-lg bg-black"></canvas>
            </div>

            <!-- Keyboard -->
            <div>
              <h3 class="text-lg font-semibold mb-4">Click letters to guess:</h3>
              <div id="keyboard" class="flex flex-wrap justify-center gap-1 mb-6">
                <!-- Keyboard will be generated here -->
              </div>

              <!-- Game Controls -->
              <div class="flex flex-wrap gap-3">
                <button id="new-game-btn" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors">
                  üéÆ New Game
                </button>
                <button id="hint-btn" class="px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors">
                  üí° Hint
                </button>
                <button id="reset-score-btn" class="px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors">
                  üîÑ Reset Score
                </button>
              </div>
            </div>
          </div>

          <!-- Instructions -->
          <div class="mt-6 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg">
            <h3 class="font-semibold mb-2">How to Play:</h3>
            <ul class="text-sm text-gray-600 dark:text-gray-400 space-y-1">
              <li>‚Ä¢ Guess letters by clicking the buttons or using your keyboard</li>
              <li>‚Ä¢ You have 6 wrong guesses before the game ends</li>
              <li>‚Ä¢ Words are programming and technology related</li>
              <li>‚Ä¢ Use the hint button if you're stuck (reveals a random letter)</li>
            </ul>
          </div>
        `;
        gameContent.classList.remove("hidden");

        // Load and initialize code hangman
        const gameWindow = window as GameWindow;
        if (gameWindow.CodeHangman) {
          currentGame = new gameWindow.CodeHangman();
        } else {
          loadScript("/game-scripts/hangman.js", () => {
            if (gameWindow.CodeHangman) {
              const CodeHangmanClass = gameWindow.CodeHangman;
              setTimeout(() => {
                currentGame = new CodeHangmanClass();
              }, 100);
            }
          });
        }
      } else if (gameType === "typing-test") {
        gameTitle.textContent = "‚å®Ô∏è Typing Speed Test";
        const gameContent = document.getElementById("typing-test-game");
        if (!gameContent) return;

        gameContent.innerHTML = `
          <div class="max-w-4xl mx-auto">
            <!-- Stats -->
            <div class="grid grid-cols-4 gap-3 mb-6">
              <div class="text-center p-3 bg-indigo-100 dark:bg-indigo-900/20 rounded-lg">
                <div class="text-2xl font-bold text-indigo-600" id="wpm">0</div>
                <div class="text-xs text-gray-600 dark:text-gray-400">WPM</div>
              </div>
              <div class="text-center p-3 bg-green-100 dark:bg-green-900/20 rounded-lg">
                <div class="text-2xl font-bold text-green-600" id="accuracy">100%</div>
                <div class="text-xs text-gray-600 dark:text-gray-400">Accuracy</div>
              </div>
              <div class="text-center p-3 bg-purple-100 dark:bg-purple-900/20 rounded-lg">
                <div class="text-2xl font-bold text-purple-600" id="time">0s</div>
                <div class="text-xs text-gray-600 dark:text-gray-400">Time</div>
              </div>
              <div class="text-center p-3 bg-orange-100 dark:bg-orange-900/20 rounded-lg">
                <div class="text-2xl font-bold text-orange-600" id="best-wpm">0</div>
                <div class="text-xs text-gray-600 dark:text-gray-400">Best WPM</div>
              </div>
            </div>

            <!-- Controls -->
            <div class="flex flex-wrap gap-2 mb-6">
              <button id="new-test-btn" class="px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700">New Snippet</button>
              <button id="reset-test-btn" class="px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700">Reset</button>
              <label class="flex items-center gap-2 ml-4">
                <input type="checkbox" id="focus-mode" class="form-checkbox">
                <span class="text-sm">Focus Mode</span>
              </label>
            </div>

            <!-- Code Display -->
            <div id="code-display" class="font-mono text-lg bg-gray-900 text-gray-100 p-6 rounded-lg mb-6 leading-relaxed whitespace-pre-wrap"></div>

            <!-- Input -->
            <textarea id="typing-input" class="w-full p-4 font-mono text-lg border-2 border-indigo-300 dark:border-indigo-600 rounded-lg bg-white dark:bg-gray-800 focus:border-indigo-500 focus:outline-none" rows="4" placeholder="Start typing here..."></textarea>

            <!-- Status -->
            <div id="status" class="text-center p-3 bg-gray-100 dark:bg-gray-700 rounded-lg mt-4">
              Start typing to begin the test!
            </div>
          </div>
        `;
        gameContent.classList.remove("hidden");

        const gameWindow = window as GameWindow;
        if (gameWindow.TypingTest) {
          currentGame = new gameWindow.TypingTest();
        } else {
          loadScript("/game-scripts/typing-test.js", () => {
            if (gameWindow.TypingTest) {
              const TypingTestClass = gameWindow.TypingTest;
              setTimeout(() => {
                currentGame = new TypingTestClass();
              }, 100);
            }
          });
        }
      } else if (gameType === "dev-bingo") {
        gameTitle.textContent = "üéØ Developer Bingo";
        const gameContent = document.getElementById("dev-bingo-game");
        if (!gameContent) return;

        gameContent.innerHTML = `
          <style>
            .bingo-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px; max-width: 600px; margin: 0 auto; }
            .bingo-cell { aspect-ratio: 1; display: flex; align-items: center; justify-content: center; text-align: center;
              padding: 8px; font-size: 11px; font-weight: 500; border-radius: 8px; cursor: pointer; transition: all 0.2s;
              background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%); border: 2px solid #d1d5db; }
            .dark .bingo-cell { background: linear-gradient(135deg, #374151 0%, #1f2937 100%); border-color: #4b5563; color: #f3f4f6; }
            .bingo-cell:hover { transform: scale(1.05); box-shadow: 0 4px 12px rgba(0,0,0,0.15); }
            .bingo-cell.marked { background: linear-gradient(135deg, #10b981 0%, #059669 100%); border-color: #047857; color: white; }
            .bingo-cell.free { background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%); border-color: #6d28d9; color: white; cursor: default; }
            .bingo-cell.winning { animation: pulse-win 0.5s ease-in-out infinite alternate; }
            @keyframes pulse-win { from { transform: scale(1); } to { transform: scale(1.05); box-shadow: 0 0 20px rgba(16, 185, 129, 0.5); } }
          </style>

          <div class="max-w-2xl mx-auto">
            <!-- Status -->
            <div id="bingo-status" class="text-center p-4 bg-pink-100 dark:bg-pink-900/20 rounded-lg mb-6">
              <div class="text-xl font-bold text-pink-600" id="bingo-message">Click squares that apply to you!</div>
              <div class="text-sm text-gray-600 dark:text-gray-400 mt-1">
                Marked: <span id="marked-count">0</span>/25 | Lines: <span id="lines-count">0</span>
              </div>
            </div>

            <!-- Bingo Grid -->
            <div id="bingo-grid" class="bingo-grid mb-6"></div>

            <!-- Controls -->
            <div class="flex flex-wrap justify-center gap-3">
              <button id="new-card-btn" class="px-4 py-2 bg-pink-600 text-white rounded-md hover:bg-pink-700">New Card</button>
              <button id="reset-bingo-btn" class="px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700">Reset Marks</button>
              <button id="share-btn" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700">Share Card</button>
            </div>

            <!-- Instructions -->
            <div class="mt-6 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg text-sm">
              <p class="font-semibold mb-2">How to Play:</p>
              <ul class="space-y-1 text-gray-600 dark:text-gray-400">
                <li>‚Ä¢ Click any square that describes something you've experienced</li>
                <li>‚Ä¢ Get 5 in a row (horizontal, vertical, or diagonal) to win!</li>
                <li>‚Ä¢ The center square is a FREE space</li>
                <li>‚Ä¢ Share your card with friends to compare!</li>
              </ul>
            </div>
          </div>
        `;
        gameContent.classList.remove("hidden");

        const gameWindow = window as GameWindow;
        if (gameWindow.DevBingo) {
          currentGame = new gameWindow.DevBingo();
        } else {
          loadScript("/game-scripts/dev-bingo.js", () => {
            if (gameWindow.DevBingo) {
              const DevBingoClass = gameWindow.DevBingo;
              setTimeout(() => {
                currentGame = new DevBingoClass();
              }, 100);
            }
          });
        }
      }

      gameContainer.classList.remove("hidden");
      gameContainer.scrollIntoView({ behavior: "smooth" });
    }

    function hideGame() {
      const gameContainer = document.getElementById("game-container");
      if (!gameContainer) return;

      if (currentGame && typeof currentGame.destroy === "function") {
        currentGame.destroy();
        currentGame = null;
      }

      gameContainer.classList.add("hidden");
      currentGame = null;
    }

    function loadScript(src: string, callback: () => void) {
      const script = document.createElement("script");
      script.src = src;
      script.onload = callback;
      script.onerror = () => console.error(`Failed to load script: ${src}`);
      document.head.appendChild(script);
    }

    // Make functions globally available
    const gameWindow = window as GameWindow;
    gameWindow.showGame = showGame;
    gameWindow.hideGame = hideGame;
  </script>
</Layout>
